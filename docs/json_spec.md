# 鋼桁橋IFCモデル生成システム - JSON入力ファイル仕様書

## 1. 概要

本仕様書は、鋼桁橋（Steel Girder Bridge）のIFCモデルを生成するためのJSON入力ファイルの構造と各フィールドの意味を定義します。JSONファイルは、Excelファイルから自動生成することも、手動で作成することもできます。

## 2. JSONファイルの全体構造

JSONファイルは最上位で以下のキーを持つオブジェクトです：

```json
{
    "Infor": { ... },
    "Senkei": [ ... ],
    "Calculate": [ ... ],
    "MainPanel": [ ... ],
    "SubPanel": [ ... ],
    "Taikeikou": [ ... ],
    "Yokokou": [ ... ],
    "Shouban": [ ... ],
    "MemberSPL": [ ... ],
    "MemberRib": [ ... ],
    "MemberData": [ ... ]
}
```

各セクションは省略可能ですが、最低限 `"Infor"` と `"Senkei"` は必須です。

## 3. 各セクションの詳細仕様

### 3.1 Infor（橋梁基本情報）

橋梁全体の基本情報を定義します。

```json
{
    "NameBridge": "橋梁名（文字列）",
    "SideExport": 2  // エクスポート側: 2=両側、1=上側のみ、-1=下側のみ
}
```

**フィールド説明：**
- `NameBridge`: 橋梁の名称（例: "Bridge Test"）
- `SideExport`: エクスポートする側面を指定
  - `2`: 両側をエクスポート
  - `1`: 上側（UF, Upper Flange）のみエクスポート
  - `-1`: 下側（LF, Lower Flange）のみエクスポート

---

### 3.2 Senkei（線形データ）

橋梁の座標系を定義する線形データです。各線形は複数の座標点で構成されます。

```json
[
    {
        "Name": "線形名称（例: TG1L, TG1, TG1R）",
        "Point": [
            {
                "Name": "点名称（例: P26, GE1, S1, C1, J1）",
                "X": 329493.70973552467,  // X座標（mm単位）
                "Y": 556065.867530174,    // Y座標（mm単位）
                "Z": 33647.799999999996   // Z座標（mm単位）
            },
            ...
        ]
    },
    ...
]
```

**フィールド説明：**
- `Name`: 線形の名称。通常、桁番号と位置を表す（例: "TG1L"=桁1左、"TG1"=桁1中央、"TG1R"=桁1右、"BG1"=桁1下フランジ）
- `Point`: 座標点の配列
  - `Name`: 点の名称。断面を表す点（例: "P26", "GE1"=端部、 donated、"S1"=スタート点、"C1"=中間点、"J1"=ジョイント）
  - `X`, `Y`, `Z`: 3次元座標値（単位: mm）。Excelから読み込む際はメートル単位を1000倍してmmに変換

**線形の種類：**
- `TG*L`, `TG*`, `TG*R`: 上フランジ（Top Girder）の左・中央・右線形
- `BG*L`, `BG*`, `BG*R`: 下フランジ（Bottom Girder）の左・中央・右線形

---

### 3.3 Calculate（計算線形データ） - オプション

既存の線形から新しい線形を計算生成するための定義です。

```json
[
    {
        "Name": "新しい線形名",
        "Calculations": [
            {
                "Type": "OFFSET",  // または "MID", "Z"
                "BaseLine": "基準線形名",
                "Distance": 距離値（mm）
            },
            {
                "Type": "MID",
                "BaseLine1": "基準線形1",
                "BaseLine2": "基準線形2"
            },
            ...
        ]
    },
    ...
]
```

**フィールド説明：**
- `Name`: 計算によって生成される新しい線形の名称
- `Calculations`: 計算処理の配列
  - `Type`: 計算タイプ
    - `"OFFSET"`: 基準線形から指定距離だけオフセット
    - `"Z"`: Z座標方向にオフセット
    - `"MID"`: 2つの基準線形の中間線を生成
  - `BaseLine`, `BaseLine1`, `BaseLine2`: 基準となる線形名（`Senkei`内の線形名を参照）
  - `Distance`: オフセット距離（mm単位）

---

### 3.4 MainPanel（メインパネルデータ）

メインパネル（主桁の主要部材）の定義です。Web（ウェブ）、Upper Flange（上フランジ）、Lower Flange（下フランジ）などのパネルが含まれます。

```json
[
    {
        "Name": "パネル名称（例: G1B1W, G2B1UF）",
        "Line": ["TG1L", "TG1", "TG1R"],  // 使用する線形名の配列
        "Sec": ["GE1", "S1", "C1", "C2", "J1"],  // 使用する断面点名称の配列
        "Type": {
            "Girder": "G1",      // 桁番号
            "Block": "B1",       // ブロック番号
            "TypePanel": "W"     // パネルタイプ: W=Web, UF=Upper Flange, LF=Lower Flange, WL=Web Left, WR=Web Right
        },
        "Material": {
            "Thick1": 4.5,       // 厚さ1（mm）
            "Thick2": 4.5,       // 厚さ2（mm）
            "Mat": "SM400A"      // 材料名
        },
        "Expand": {
            "E1": 0,             // 左側延長（mm）。数値または"A"（自動）
            "E2": -0.5,          // 右側延長（mm）。数値または"A"（自動）
            "E3": "A",           // 上側延長（mm）。数値または"A"（自動）
            "E4": "A"            // 下側延長（mm）。数値または"A"（自動）
        },
        "Jbut": {
            "S": ["TG2-BG2", "X/WFJ1/X", "TG2-BG2", "X/WBJ1/X"],  // 始端側のジョイント情報
            "E": []              // 終端側のジョイント情報
        },
        "Break": {              // オプション: パネル分割情報
            "Lenght": [19675, 900],
            "Extend": [0, 0],
            "Thick": ["0/22", "0/30"]
        },
        "Corner": [],           // オプション: コーナーカット情報 [corner1, corner2, corner3, corner4]
        "Lrib": [],             // オプション: 縦リブ情報
        "Vstiff": [],           // オプション: 垂直補剛材情報
        "Hstiff": [],           // オプション: 水平補剛材情報
        "Atm": [],              // オプション: アンカーボルト・台座情報
        "Cutout": [],           // オプション: 切り欠き情報
        "Stud": []              // オプション: スタッド情報
    },
    ...
]
```

**フィールド詳細説明：**

#### 3.4.1 Type（パネルタイプ）

- `"W"`: Web（ウェブ）パネル - 両側生成
- `"WL"`: Web Left - 左側のみ
- `"WR"`: Web Right - 右側のみ
- `"UF"`: Upper Flange（上フランジ）
- `"LF"`: Lower Flange（下フランジ）

#### 3.4.2 Expand（延長）

各方向の延長量を指定します。数値（mm）または `"A"`（自動計算）を指定可能です。

#### 3.4.3 Jbut（ジョイント）

スプリットプレート（SPL）の配置情報です。

```json
{
    "S": ["線形名", "ピッチ情報", "線形名", "ピッチ情報", ...],  // 始端側（Start）
    "E": ["線形名", "ピッチ情報", ...]                          // 終端側（End）
}
```

ピッチ情報の形式例：
- `"X/WFJ1/X"`: 線形方向にX、断面方向にWFJ1、もう一方にX
- `"40/LFJ23/X"`: 線形方向に40mm、断面方向にLFJ23、もう一方にX

#### 3.4.4 Break（パネル分割）

パネルを複数の区間に分割する場合の情報です。

```json
{
    "Lenght": [区間1の長さ, 区間2の長さ, ...],  // mm単位
    "Extend": [区間1の延長, 区間2の延長, ...],
    "Thick": ["Thick1/Thick2", "Thick1/Thick2", ...]  // 各区間の厚さ
}
```

#### 3.4.5 Corner（コーナーカット）

4隅のコーナーカット情報です。

```json
["corner1", "corner2", "corner3", "corner4"]
```

- `"N"`: カットなし
- `"R数値"`: 半径数値mmの丸み（例: "R50"）
- `"C数値"` または `"C数値x数値"`: 角カット（例: "C15" または "C15x10"）

#### 3.4.6 Lrib（縦リブ）

縦リブ（Long Rib）の配置情報です。

```json
[
    ["線形名", "ピッチ", "点名称範囲"],  // 最初の要素はピッチ定義
    {
        "Line": "点名称範囲（例: V1-V13）",
        "Point": "断面点名称（例: TG2-BG2）",
        "Face": "R",  // 配置面: "L"=左, "R"=右, "T"=上, "B"=下
        "Name": "リブ名称範囲（例: VS1-VS13）",
        "Ref": "参照リブ名（MemberRib内の名称）"
    },
    ...
]
```

#### 3.4.7 Vstiff（垂直補剛材）

垂直補剛材（Vertical Stiffener）の配置情報です。

```json
[
    ["計算タイプ", "上側ピッチ", "下側ピッチ", "点名称範囲"],  // 最初の要素はピッチ定義
    {
        "Line": "点名称範囲",
        "Point": "断面点名称",
        "Face": "R",  // または "ALL", "L"
        "Name": "補剛材名称範囲",
        "Ref": "参照補剛材名（MemberRib内の名称）"
    },
    ...
]
```

計算タイプ: `"XY"`（XY平面での計算）など

#### 3.4.8 Hstiff（水平補剛材）

水平補剛材（Horizontal Stiffener）の配置情報です。

```json
[
    ["線形名", "ピッチ", "点名称範囲"],
    {
        "Line": "点名称範囲",
        "Point": "断面点名称範囲",
        "Face": "R",
        "Name": "補剛材名称",
        "Ref": "参照補剛材名"
    },
    ...
]
```

#### 3.4.9 Atm（アンカーボルト・台座）

アンカーボルトや台座の配置情報です。

```json
[
    [
        ["方向", "ピッチ"],  // 縦方向ピッチ
        ["線形名", "ピッチ"]  // 横方向ピッチ
    ],
    {
        "Angle": ["角度1", "角度2"],  // 角度設定（"V"=垂直、数値=角度）
        "Face": "L",  // 配置面
        "Name": "部材名称",
        "Ref": "参照部材名（MemberData内の名称、例: ASHIBAR）"
    },
    ...
]
```

#### 3.4.10 Cutout（切り欠き）

パネルの切り欠き情報です。

```json
[
    [
        ["断面範囲", "ピッチ"],  // 縦方向
        ["線形名", "ピッチ"]     // 横方向
    ],
    {
        "Face": "L",  // 配置面
        "Ref": "参照部材名（MemberData内の名称）"
    },
    ...
]
```

#### 3.4.11 Stud（スタッド）

スタッドの配置情報です。

```json
[
    [
        ["方向", "ピッチ"],
        ["線形名", "ピッチ"]
    ],
    {
        "Face": "T",  // 配置面
        "Ref": "参照部材名（MemberData内の名称、例: ST1）"
    },
    ...
]
```

---

### 3.5 SubPanel（サブパネルデータ） - オプション

サブパネル（補助的な部材パネル）の定義です。

```json
[
    {
        "Name": "サブパネル名称",
        "Girder": "桁番号",
        "Sec": ["断面開始", "断面終了"],
        "Point": [
            ["点名称1", "点名称2", "点名称3"],
            ...
        ],
        "Part": [
            {
                "Name": "パート名称",
                "Material": {
                    "Thick1": 4.5,
                    "Thick2": 4.5,
                    "Mat": "SM400A"
                },
                "Out": {
                    "L": ["LINE", "P7", "P4"],
                    "R": ["LINE", "P4", "P3", "P2"],
                    "T": ["LINE", "P2", "P1B"],
                    "B": ["ARC", "P8", "P1T", "P7"]
                },
                "Extend": {
                    "L": 0,
                    "R": 0,
                    "T": 0,
                    "B": 0
                },
                "Corner": [],
                "Slot": [],
                "Joint": {
                    "S": [],
                    "E": []
                },
                "Cutout": [],
                "Stiff": [],
                "FLG": {
                    "UFLG": [],
                    "LFLG": []
                }
            },
            ...
        ]
    },
    ...
]
```

**フィールド説明：**
- `Point`: パネルの座標点を定義する点の組み合わせ
- `Part`: パートの配列
  - `Out`: 外形定義。`"LINE"`（直線）または`"ARC"`（円弧）で点を接続
  - その他のフィールドは`MainPanel`と同様

---

### 3.6 Taikeikou（対傾構データ） - オプション

対傾構（Diagonal Bracing）の定義です。

```json
[
    {
        "Name": "対傾構名称（例: C1）",
        "Type": ["Type1D", "位置1", "位置2"],  // Type1D=下側、Type1U=上側
        "Girder": ["G3", "G4"],  // 接続する桁番号
        "Point": ["TG3", "TG4", "BG4", "BG3"],  // 接続点の線形名
        "Distmod": {
            "TL": [75, 150],  // 左上（Top Left）の距離修正 [X, Y]
            "TR": [75, 150],  // 右上
            "BL": [75, 250],  // 左下（Bottom Left）
            "BR": [75, 250]   // 右下
        },
        "Hole": {
            "TL": [直径, "ピッチ", 0],
            "TR": [直径, "ピッチ", 0],
            "BL": [直径, "ピッチ", 0],
            "BR": [直径, "ピッチ", 0]
        },
        "Vstiff": {
            "L": [厚さ, 材料, 幅],
            "R": [厚さ, 材料, 幅]
        },
        "Shape": {
            "T": ["方向", "サイズ", "材料", "タイプ", 角度, "ピッチ"],
            "B": [...],
            "L": [...],
            "R": [...]
        },
        "Guss": {
            "TL": [厚さ, 材料, "寸法", "延長", 角度],
            "TR": [...],
            "BL": [...],
            "BR": [...],
            "Mid": [厚さ, 材料, "寸法", X, Y, Z]
        }
    },
    ...
]
```

---

### 3.7 Yokokou（横構データ） - オプション

横構（Cross Bracing）の定義です。

```json
[
    {
        "Name": "横構名称（例: G1-G2）",
        "Type": ["L", "B"],  // タイプ（L=左、R=右、CL=中央左、CR=中央右、B=下側）
        "Girder": ["G1/W", "G2/W"],  // 接続する桁/パネル
        "Point": ["S1", 180, 0, "V2", 180, 490, "C1", 180, 0, ...],  // 点とオフセットの交互配列
        "Shape": [
            {
                "Name": "形状名称（例: Sh1）",
                "Infor": ["CT", "118x176x8x8", "SS400"],  // タイプ、サイズ、材料
                "Point": ["S1", "V2", "C1"],  // 形状の基準点
                "Pitch": [390, "X", 137],  // ピッチ情報
                "Hole": {
                    "S": [直径, "ピッチX", "ピッチY"],  // 始端側の穴
                    "E": [直径, "ピッチX", "ピッチY"]   // 終端側の穴
                }
            },
            ...
        ],
        "Guss": [
            {
                "Name": "ガセット名称",
                "Infor": [厚さ, 材料],
                "Point": "接続点名称",
                "Face": ["TK", "A160", "YK", "O40"],  // 面情報
                "Edge": ["P", "P"],  // エッジ情報
                "KL": [1, 8, 10],  // KL情報（オプション）
                "Slot": "スロット名"  // または "N"
            },
            ...
        ]
    },
    ...
]
```

---

### 3.7.1 Yokokou_Structural（横桁データ） - オプション

横桁（Cross Beam / Structural Lateral Bracing）の定義です。主桁同士を水平方向につなぐトラス状の部材で、橋の横方向の剛性を高めます。

```json
[
    {
        "Name": "横桁名称（例: YS_G1_G2）",
        "Position": "Bottom",           // "Top" or "Bottom"（省略時: "Bottom"）
        "Girder": ["G1", "G2"],         // 接続する桁番号の配列
        "SectionRange": ["S1", "E1"],   // 断面範囲（省略時: ["S1", "E1"]）
        "ZOffset": 0,                   // Z方向オフセット（mm）（省略時: 0）
        "Truss": {                      // トラス情報（省略可）
            "Chord": ["CT", "118x176x8x8", "SM400A"],   // 弦材の形状
            "Diagonal": ["CT", "95x152x8x8", "SM400A"]  // 斜め材の形状
        },
        "Hole": {                       // 穴情報（省略可）
            "S": [直径, "ピッチX", "ピッチY"],  // 始端側
            "E": [直径, "ピッチX", "ピッチY"]   // 終端側
        },
        "Guss": []                      // ガセット情報（省略可）
    },
    ...
]
```

**フィールド説明：**
- `Name`: 横桁の名称
- `Position`: 配置位置
  - `"Top"`: 上側（上フランジレベル）
  - `"Bottom"`: 下側（下フランジレベル）
- `Girder`: 接続する主桁の番号（例: `["G1", "G2"]` で G1 と G2 を接続）
- `SectionRange`: 横桁を配置する断面範囲
- `ZOffset`: Z方向（高さ方向）のオフセット量（mm）
- `Truss`: トラス部材の形状情報
  - `Chord`: 弦材（水平部材）の形状 [タイプ, サイズ, 材料]
  - `Diagonal`: 対角材（斜め部材）の形状 [タイプ, サイズ, 材料]
- `Hole`: ボルト穴情報
- `Guss`: ガセットプレート情報

**使用例：**

```json
{
    "Name": "YS_G1_G2",
    "Position": "Bottom",
    "Girder": ["G1", "G2"],
    "SectionRange": ["S1", "E1"],
    "ZOffset": 0,
    "Truss": {},
    "Hole": {},
    "Guss": []
}
```

---

### 3.7.2 Yokogeta（I形横桁データ） - オプション

I形横桁（Cross Beam）の定義です。主桁間を繋ぐI形断面の構造部材で、ウェブ+上フランジ+下フランジのプレートで構成されます。

```json
[
    {
        "Name": "横桁名称（例: CB_G1_G2_C3）",
        "Girder": ["G1", "G2"],         // 接続する桁番号の配列（2つ指定）
        "Section": "C3",                // 配置する断面位置
        "Reference": "Bottom",          // "Top" or "Bottom"（省略時: "Bottom"）
        "Height": 600,                  // 横桁のせい（mm）
        "ZOffset": 0,                   // 基準位置からのオフセット（mm）（省略時: 0）
        "Web": {                        // ウェブ情報
            "Thick": 12,                // 板厚（mm）
            "Mat": "SM400A"             // 材料
        },
        "UFlange": {                    // 上フランジ情報
            "Thick": 16,                // 板厚（mm）
            "Width": 200,               // フランジ幅（mm）
            "Mat": "SM400A"             // 材料
        },
        "LFlange": {                    // 下フランジ情報
            "Thick": 16,                // 板厚（mm）
            "Width": 200,               // フランジ幅（mm）
            "Mat": "SM400A"             // 材料
        },
        "Break": {                      // 分割情報（省略時: 分割なし）
            "Count": 2                  // 分割数
        }
    },
    ...
]
```

**フィールド説明：**
- `Name`: 横桁の名称
- `Girder`: 接続する主桁の番号（2つ指定、例: `["G1", "G2"]` で G1 と G2 を接続）
- `Section`: 横桁を配置する断面位置（例: "C1", "C3" など）
- `Reference`: 配置基準位置
  - `"Top"`: 横桁上フランジが主桁上フランジ下面に合う
  - `"Bottom"`: 横桁下フランジが主桁下フランジ上面に合う
- `Height`: 横桁のせい（断面高さ、mm）
- `ZOffset`: 基準位置からの上下オフセット（mm）
- `Web`: ウェブプレートの情報
  - `Thick`: 板厚（mm）
  - `Mat`: 材料名
- `UFlange`: 上フランジプレートの情報
  - `Thick`: 板厚（mm）
  - `Width`: フランジ幅（mm）
  - `Mat`: 材料名
- `LFlange`: 下フランジプレートの情報（UFlangeと同様）
- `Break`: 厚さ方向分割情報（省略可能、損傷面識別用）
  - `Count`: 分割数（1以上の整数、省略時は1=分割なし）
  - 各プレートを厚さ方向に分割（例: 16mm厚を2分割 → 8mm×2枚）
  - 分割時は要素名に `_1`, `_2` などのサフィックスが付きます
  - 命名規則:
    - 上フランジ: `_UF_1`=上面側（外面）、`_UF_2`=下面側（内面）
    - 下フランジ: `_LF_1`=下面側（外面）、`_LF_2`=上面側（内面）
    - ウェブ: `_Web_1`=外面側、`_Web_2`=内面側

**使用例：**

```json
{
    "Name": "CB_G1_G2_C3",
    "Girder": ["G1", "G2"],
    "Section": "C3",
    "Reference": "Bottom",
    "Height": 600,
    "ZOffset": 0,
    "Web": {"Thick": 12, "Mat": "SM400A"},
    "UFlange": {"Thick": 16, "Width": 200, "Mat": "SM400A"},
    "LFlange": {"Thick": 16, "Width": 200, "Mat": "SM400A"},
    "Break": {"Count": 2}
}
```

上記の例では、各プレートが厚さ方向に2分割され、以下の6要素が生成されます:
- `CB_G1_G2_C3_Web_1`, `CB_G1_G2_C3_Web_2` （ウェブ）
- `CB_G1_G2_C3_UF_1`, `CB_G1_G2_C3_UF_2` （上フランジ: 上面側/下面側）
- `CB_G1_G2_C3_LF_1`, `CB_G1_G2_C3_LF_2` （下フランジ: 下面側/上面側）

これにより、損傷情報を入力する際にどちらの面に損傷があるかを区別できます。

**注意：**
- 横桁の両端位置は、指定した主桁のウェブ中心位置から自動計算されます
- 横桁のせい（Height）は主桁のウェブ高さ内に収まるように設定してください

---

### 3.8 Shouban（床版データ） - オプション

床版（Deck Slab）の定義です。

```json
[
    {
        "Name": "Deck_Main",
        "Line": ["TG1L", "TG1R", "TG4R", "TG4L"],
        "Sec": ["S1", "C1", "C2", "C3", "E1"],
        "Thick": 200.0,
        "OverhangLeft": 500.0,
        "OverhangRight": 500.0,
        "ZOffset": 0.0,
        "Break": {
            "Thick": 2,
            "X": 4,
            "Y": 5,
            "NoThickBreakForFlange": true
        },
        "Guardrail": {
            "Left": {"Width": 200.0, "Height": 1000.0, "Break": false},
            "Right": {"Width": 200.0, "Height": 1000.0, "Break": false}
        }
    },
    ...
]
```

**フィールド説明：**

| フィールド | 型 | デフォルト | 説明 |
|-----------|-----|---------|------|
| `Name` | string | 必須 | 床版の名称 |
| `Line` | list | 必須 | 床版の4隅を定義する線形名（左上、右上、右下、左下の順） |
| `Sec` | list | 必須 | 使用する断面点名称の配列 |
| `Thick` | float | 200.0 | 床版厚さ（mm） |
| `OverhangLeft` | float | 0 | 左側張り出し長さ（mm） |
| `OverhangRight` | float | 0 | 右側張り出し長さ（mm） |
| `ZOffset` | float | 0.0 | Z方向オフセット（mm） |
| `Break` | dict | {} | 分割情報（下記参照） |
| `Guardrail` | dict | {} | 高欄情報（下記参照） |

#### 3.8.1 Break（分割情報）

```json
{
    "Thick": 2,                    // 厚さ方向の分割数（デフォルト: 1）
    "X": 4,                        // X方向（橋軸方向）の分割数
    "Y": 5,                        // Y方向（橋軸直角方向）の分割数
    "NoThickBreakForFlange": true  // 上フランジ部分では厚さ分割しないフラグ
}
```

**X/Y分割の拡張形式:**

```json
// セクション位置で分割
{"Type": "sections", "Sections": ["S1", "C1", "C5", "S2"]}

// ウェブ位置で分割
{"Type": "webs", "Girders": ["G1", "G2", "G3"]}

// 等分割
{"Type": "equal", "Count": 4}
```

#### 3.8.2 Guardrail（高欄情報）

```json
{
    "Left": {
        "Width": 200.0,    // 高欄の幅（mm）
        "Height": 1000.0,  // 高欄の高さ（mm）
        "Break": false     // 分割するかどうか
    },
    "Right": {
        "Width": 200.0,
        "Height": 1000.0,
        "Break": false
    }
}
```

---

### 3.9 MemberSPL（メンバーSPLデータ） - オプション

スプリットプレート（SPL）のメンバー定義です。

```json
[
    {
        "Name": "SPL名称",
        "Infor": {
            "Thick": 厚さ（mm）,
            "Mat": 材料名,
            "Side": "側面",
            "Ang": 角度,
            "GLine": 基準線形名
        },
        "PJ": ["ピッチ1", "ピッチ2", ...],  // ジョイント方向のピッチ
        "PL": ["ピッチ1", ...],  // 左側のピッチ
        "PR": ["ピッチ1", ...],  // 右側のピッチ
        "Out": [X1, Y1, X2, Y2],  // 外形オフセット
        "Dhole": [直径1, 直径2],  // 穴の直径
        "Solid": [長さ1, 長さ2]   // ソリッド長さ
    },
    ...
]
```

---

### 3.10 MemberRib（メンバーリブデータ） - オプション

リブ（補剛材）のメンバー定義です。

```json
[
    {
        "Name": "リブ名称（例: VSREF1, HSREF）",
        "Infor": {
            "Thick1": 厚さ1（mm）,
            "Thick2": 厚さ2（mm）,
            "Mat": 材料名,
            "Width": 幅（mm）
        },
        "Ang": [角度1, 角度2, 角度3],
        "Extend": [拡張1, 拡張2, 拡張3, 拡張4],  // または数値、"Auto"、"N"
        "Corner": [corner1, corner2, corner3, corner4],
        "JointS": [],  // 始端側のジョイント
        "JointE": []   // 終端側のジョイント
    },
    ...
]
```

---

### 3.11 MemberData（メンバーデータ） - オプション

その他の部材データ（スロット、穴、アンカーボルト、スタッドなど）の定義です。

#### 3.11.1 SLOT（スロット）

```json
{
    "Name": "スロット名称",
    "Infor": [タイプ],
    "Wide": [左側幅, 右側幅],
    "Radius": [半径]
}
```

#### 3.11.2 HOLE（穴）

```json
{
    "Name": "穴名称",
    "Infor": [タイプ],
    "Length": [長さ1, 長さ2],
    "Width": [幅1, 幅2],
    "Radius": [半径1, 半径2, 半径3, 半径4],
    "Stiff": [
        [距離修正1, 距離修正2, 距離修正3, 距離修正4],
        [補剛材名1, 補剛材名2, 補剛材名3, 補剛材名4]
    ]
}
```

#### 3.11.3 ASHIBA / TAICAU（アンカーボルト・台座）

```json
{
    "Name": "部材名称（例: ASHIBAR）",
    "Infor": [タイプ, パラメータ1, パラメータ2, 材料],
    "Point": [
        ["点名称", X座標, Y座標, Z座標],
        ...
    ],
    "Out": [
        ["LINE", "P7", "P4"],
        ["ARC", "P8", "P1T", "P7"],
        ...
    ],
    "Hole": [
        ["点名称", "タイプ", 半径],
        ...
    ]
}
```

- `Out`の要素:
  - `["LINE", "点1", "点2", ...]`: 直線で接続
  - `["ARC", "点1", "点2", "点3"]`: 円弧で接続（点2が中心）

#### 3.11.4 STUD（スタッド）

```json
{
    "Name": "スタッド名称（例: ST1）",
    "Infor": [タイプ, サイズ, 材料],  // 例: ["STUD", "20x140", "SS400"]
    "Nut": [サイズ]  // 例: ["30x10"]
}
```

---

## 4. ピッチ表記の仕様

### 4.1 基本形式

ピッチは `/` で区切られた数値の列です：

```
"100/200/300"  // 100mm, 200mm, 300mm のピッチ
```

### 4.2 繰り返し表記

`@` を使用して繰り返しを表現：

```
"3@100"  // 100mmを3回繰り返し
"3@100/200/50"  // 100mmを3回、200mm、50mm
```

### 4.3 未知数（X）の使用

合計長さから自動計算される未知数を `X` で表現：

```
"100/200/X"  // 最初の2つのピッチは固定、残りはXとして計算
"3@100/X"    // 100mmを3回、残りはX
```

### 4.4 比率表記

`:` を使用して比率を表現：

```
"100:2"  // 100mmを2等分
```

### 4.5 複合表記

複数の形式を組み合わせ：

```
"425/10@245/16@200/30@100/250"  // 425mm, 245mm×10回, 200mm×16回, 100mm×30回, 250mm
```

---

## 5. 座標系と単位

- **座標単位**: ミリメートル（mm）
- **座標系**: 3次元直交座標系（X, Y, Z）
- Excelから読み込む際は、メートル単位の値を1000倍してmmに変換

---

## 6. 名称規則

### 6.1 線形名

- `TG*`: 上フランジ（Top Girder）
- `BG*`: 下フランジ（Bottom Girder）
- 接尾辞: `L`=左、`R`=右、なし=中央

### 6.2 断面点名

- `P*`: 基準点
- `GE*`: 端部（End）
- `S*`: スタート点
- `C*`: 中間点（Center）
- `J*`: ジョイント点

### 6.3 パネル名

形式: `{桁番号}B{ブロック番号}{タイプ}`

例：
- `G1B1W`: 桁1、ブロック1、Webパネル
- `G2B1UF`: 桁2、ブロック1、Upper Flangeパネル
- `G2B1LF`: 桁2、ブロック1、Lower Flangeパネル

---

## 7. データの依存関係

1. **Senkei** → 他の全セクションの基準となる座標データ
2. **MemberRib** → MainPanelのLrib, Vstiff, Hstiffで参照
3. **MemberSPL** → MainPanelのJbutで参照
4. **MemberData** → MainPanelのAtm, Cutout, Stud、Taikeikou、Yokokouで参照
5. **MainPanel** → SubPanel、Taikeikou、Yokokouの位置計算で参照

---

## 8. 使用例

### 8.1 最小構成のJSON

```json
{
    "Infor": {
        "NameBridge": "Test Bridge",
        "SideExport": 2
    },
    "Senkei": [
        {
            "Name": "TG1",
            "Point": [
                {"Name": "S1", "X": 0, "Y": 0, "Z": 0},
                {"Name": "E1", "X": 10000, "Y": 0, "Z": 0}
            ]
        }
    ],
    "Calculate": [],
    "MainPanel": [],
    "SubPanel": [],
    "Taikeikou": [],
    "Yokokou": [],
    "Shouban": [],
    "MemberSPL": [],
    "MemberRib": [],
    "MemberData": []
}
```

### 8.2 Webパネルの定義例

```json
{
    "Name": "G1B1W",
    "Line": ["TG1", "BG1"],
    "Sec": ["S1", "E1"],
    "Type": {
        "Girder": "G1",
        "Block": "B1",
        "TypePanel": "W"
    },
    "Material": {
        "Thick1": 4.5,
        "Thick2": 4.5,
        "Mat": "SM400A"
    },
    "Expand": {
        "E1": 0,
        "E2": 0,
        "E3": 0,
        "E4": 0
    },
    "Jbut": {"S": [], "E": []},
    "Break": {},
    "Corner": [],
    "Lrib": [],
    "Vstiff": [],
    "Hstiff": [],
    "Atm": [],
    "Cutout": [],
    "Stud": []
}
```

---

## 9. 注意事項

1. **必須フィールド**: `Infor`と`Senkei`は必須。他のセクションはオプションですが、空配列`[]`として定義することを推奨
2. **名称の一意性**: 各セクション内で名称は一意である必要があります
3. **参照の整合性**: 他のセクションを参照する際は、参照先の名称が存在することを確認してください
4. **数値の型**: 座標値は数値型（integerまたはfloat）として定義してください
5. **文字列の型**: 名称は文字列型として定義してください
6. **配列の順序**: 配列の順序は処理順序に影響する場合があります
7. **座標の単位**: すべての座標値はmm単位であることを確認してください

---

## 10. エラーハンドリング

プログラムは以下の場合にエラーを発生させる可能性があります：

- `Senkei`内に参照されている線形名が存在しない
- `MemberRib`、`MemberSPL`、`MemberData`で参照されている名称が定義されていない
- ピッチ計算で合計長さが不足する（Xが計算できない）
- 座標値が不正（NaN、無限大など）

---

## 11. 更新履歴

- 初版: 2026年1月17日
- 鋼桁橋IFCモデル生成システム用JSON仕様

---

## 12. 参考資料

- `DefJson.py`: ExcelからJSONへの変換処理
- `DefBridge.py`: JSONからのIFCモデル生成処理
- `sample.json`: 実例データファイル

